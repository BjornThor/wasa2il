{% extends "base.html" %}
{% load i18n %}
{% block content %}

<div style="float:right">
	<a class="btn meeting-ongoing" onclick="meeting_attend({{meeting.id}}, 1);">{% trans "Attend meeting" %}</a>
	<a class="btn" href="/polity/{{polity.id}}/">{% trans "Back to polity" %}</a>
</div>
<h1>{{polity.name}} meeting {{meeting.time_starts|date:"d/m/Y H:i"}}</h1>

<div style="float:right; width: 200px; background: #fff; border: 1px solid #eee; padding-left: 10px; padding-right: 10px;">
	<h4>Attendance list</h4>
	<ul class="attendancelist">
	{% for name in meeting.attendees.all %}
	<li>
	{% if name in meeting.managers.all %}<i class="icon-bullhorn"></i>
	{% else %}<i class="icon-user"></i>{% endif %}
	<a href="/accounts/profile/{{name}}/">{{name}}</a>
	</li>
	{% endfor %}
	</ul>
</div>

<div class="alert alert-info meeting-notstarted" style="width: 600px;">{% trans "This meeting will start in"%} {{self.time_starts|timeuntil}}</div>
<div class="alert alert-info meeting-ongoing" style="width: 600px;">{% trans "This meeting is ongoing."%}</div>
<div class="alert alert-info meeting-ended" style="width: 600px;">{% trans "This meeting ended at"%} {{self.time_ended|timesince}}</div>

<h2>Agenda</h2>

<div class="btn-toolbar">
	<div class="btn-group meeting-manager">
		<a class="btn btn-small btn-warning meeting-ongoing" onclick="meeting_end({{meeting.id}});"><i class="icon-stop"></i> {% trans "Meeting ended" %}</a>	
		<a class="btn btn-small btn-success meeting-notongoing" onclick="meeting_start({{meeting.id}});"><i class="icon-play"></i> {% trans "Start meeting" %}</a>	
	</div>

	<div class="btn-group">
		<a class="btn btn-small meeting-agendaopen" onclick="meeting_agenda_add({{meeting.id}});"><i class="icon-asterisk"></i> {% trans "Add agenda item" %}</a>
		<span class="meeting-manager">
			<a class="btn btn-small meeting-agendaopen" onclick="meeting_agenda_close({{meeting.id}});"><i class="icon-lock"></i> {% trans "Close agenda" %}</a>	
			<a class="btn btn-small meeting-agendaclosed" onclick="meeting_agenda_open({{meeting.id}});"><i class="icon-lock"></i> {% trans "Open agenda" %}</a>	
		</span>
	</div>

	<div class="btn-group meeting-manager">
		<a class="btn btn-small" onclick="meeting_agenda_previous({{meeting.id}});"><i class="icon-chevron-up"></i> {% trans "Previous agenda item" %}</a>
		<a class="btn btn-small" onclick="meeting_agenda_next({{meeting.id}});"><i class="icon-chevron-down"></i> {% trans "Next agenda item" %}</a>
		<a class="btn btn-small" onclick="meeting_intervention_previous({{meeting.id}});"><i class="icon-chevron-left"></i> {% trans "Previous speaker" %}</a>
		<a class="btn btn-small" onclick="meeting_intervention_next({{meeting.id}});"><i class="icon-chevron-right"></i> {% trans "Next speaker" %}</a>
	</div>

</div>

<div class="btn-toolbar meeting-attendee">
	<div class="btn-group">
		<a class="btn btn-small" onclick="meeting_intervention_add({{meeting.id}}, 1);"><i class="icon-hand-up"></i> {% trans "Want to talk" %}</a>
		<a class="btn btn-small" onclick="meeting_intervention_add({{meeting.id}}, 2);"><i class="icon-hand-left"></i> {% trans "Direct response" %}</a>
		<a class="btn btn-small" onclick="meeting_intervention_add({{meeting.id}}, 3);"><i class="icon-question-sign"></i> {% trans "Clarify" %}</a>
		<a class="btn btn-small" onclick="meeting_intervention_add({{meeting.id}}, 4);"><i class="icon-info-sign"></i> {% trans "Point of order" %}</a>
	</div>
</div>

<script>
$(function() {
	window.setInterval(function() { meeting_poll({{meeting.id}}); }, 1000);
});
</script>


{% endblock %}
